
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>RVs Part 2 - Mixture Models - PRT Blog</title>
  <meta name="author" content="Kenneth Morton and Peter Torrione">

  
  <meta name="description" content="RVs Part 2 - Mixture Models Mar 24th, 2013 In part 1 we talked about how use RVs to change the statistical model used by prtClassMap so that we can &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://newfolder.github.io/blog/2013/03/24/rvs-part-2">
  <link href="/favicon.ico" rel="icon">
  
  <link href="/assets/bootstrap/css/spacelab.min.css" rel="stylesheet" type="text/css">
  <link href="/assets/bootstrap/css/bootstrap-responsive.min.css" rel="stylesheet" type="text/css">
  <link href="/assets/bootstrap/css/custom.css" rel="stylesheet" type="text/css">
  <link href="/assets/font-awesome/css/font-awesome.css" rel="stylesheet" type="text/css">
  
  <link href="/atom.xml" rel="alternate" title="PRT Blog" type="application/atom+xml">
  <style type="text/css">
pre, tt, code { font-size:12px; }
pre { margin:0px 0px 20px; }
pre.error { color:red; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }
</style>
  

</head>

<body    data-spy="scroll">

  <div class="container">
    <header class="jumbotron subhead" id="overview">
      
<div class="subscribe">
  <table>
    <tr>
      <td><span>Get Updates: &nbsp;</span></td>
      
      
      <td><a href="/atom.xml" class="btn"><i class="icon-cog"></i> By RSS</a></td>
      
      
    </tr>
  </table>
</div>

<h1 class="title">PRT Blog</h1>

  <p class="lead">MATLAB Pattern Recognition Open Free and Easy</p>


      <div class="navbar">
  <div class="navbar-inner">
    <div class="container" style="width: auto;">
      <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </a>
      <div class="nav-collapse">
                <ul class="nav">
          <li><a href="/">Home</a></li>
          <li><a href="/blog/archives">Blog</a></li>
          <li><a href="https://github.com/newfolder/PRT">Code</a></li>
          <li><a href="/prtdoc/">Documentation</a></li>
		  <li><a href="https://github.com/newfolder/PRT/issues">Get Help</a><li>
          <li><a href="/about">About</a></li>
        </ul>

        
          <form action="http://google.com/search" method="get" class="navbar-search pull-left">
            <fieldset role="search">
              <input type="hidden" name="q" value="site:newfolder.github.io" />
              <input type="text" name="q" results="0" placeholder="Search" class="search-query span2" />
            </fieldset>
          </form>
        
        
      </div><!-- /.nav-collapse -->
    </div>
  </div><!-- /navbar-inner -->
</div>

    </header>
    <div id="main">
      <div id="content">
        <div class="row">
  
  <div class="span8">
    <br>

  <header>
    
      <h1 class="entry-title">RVs Part 2 - Mixture Models</h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-03-24T11:03:00-04:00" pubdate data-updated="true">Mar 24<span>th</span>, 2013</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>In <a href="/blog/2013/01/31/random-variables-part-1/">part 1</a> we talked about how use RVs to change the statistical model used by prtClassMap so that we can flexibly model the data. If you recall we can set the &#8220;rvs&#8221; property to correspond to prtRvMvn to model the data using multi-variate normal distributions or we can set it some other value to change the resulting model and thus the classifier. Now, we are going to talk about how we can make probabilistic mixtures in much the same way.</p>


<!--/introduction-->


<h2>Contents</h2>


<div><ul><li><a href="#1">Mixture Models</a></li><li><a href="#2">prtRvMixture</a></li><li><a href="#6">Using prtRvMixtures for Classification</a></li><li><a href="#8">prtRvGmm</a></li><li><a href="#10">Using prtRvGmm for classification</a></li><li><a href="#13">Conclusions</a></li></ul></div>


<h2>Mixture Models<a name="1"></a></h2>


<p>In general, the term &#8220;mixture model&#8221; implies that each observation of data has an associated hidden variable and that observation is drawn from a distribution that is dependent on that hidden variable. In general statistics, a mixture model can have either continuous or discrete hidden variables. In the PRT, our prtRvMixture only considers discrete mixtures. That is, there are fixed number of &#8220;components&#8221; each with a mixing proportion and each component is itself a parameterized distribution, like a Gaussian.</p>


<p>The most common mixture is the Gaussian mixture model (GMM). A guassian mixture model with K components has a K dimensional discrite distrubtion for the mixing variable and has K individual Gaussian components. Today&#8217;s post will focus on using working with Gaussian mixture models.</p>


<h2>prtRvMixture<a name="2"></a></h2>


<p>prtRvMixture has two main properties that are of interest &#8220;components&#8221; and &#8220;mixingProportions&#8221;.</p>


<p>components should be an array of prtRvs that also inherit from prtRvMembershipModel. Without getting too indepth a prtRvMembershipModel is a special attribute of some prtRvs that specifies that this RV knows how to work inside of a mixture model. As we mentioned before, we are focusing on mixture of prtRvMvn objects to make a Gaussian mixture model. Luckily prtRvMvn inherits from prtRvMembershipModel and therefore it knows how to work in a mixture.</p>


<p>mixingProportions is the discrite mixing density for the mixture model. It should be a vector that sums to one with the same length as the &#8220;components&#8221; array.</p>


<p>To get started let&#8217;s make an array of 2D MVN RV objects with different means and a non-diagonal covariance matrix.</p>


<pre class="codeinput">gaussianSet1 = repmat(prtRvMvn(<span class="string">'sigma'</span>,[1 -0.5; -0.5 2;]),2,1);
gaussianSet1(1).mu = [-2 -2];
gaussianSet1(2).mu = [2 2];
</pre>


<p>Then we will can make a mixture by specifying some mixingProportions</p>


<pre class="codeinput">mixture1 = prtRvMixture(<span class="string">'components'</span>,gaussianSet1,<span class="string">'mixingProportions'</span>,[0.5 0.5]);
</pre>


<p>Because prtRvMixtures are prtRvs we get all of the nice plotting that comes along with things. Let&#8217;s take  a look at the density of our prtRv</p>


<pre class="codeinput">plotPdf(mixture1);
</pre>


<p><img vspace="5" hspace="5" src="/images/morton_blog_20130227_01.png" alt=""> <p>To show how we can do classification with these mixtures, let&rsquo;s make another mixture with different parameters. Then we will draw some data from both mixtures and plot our classification dataset.</p><pre class="codeinput">gaussianSet2 = repmat(prtRvMvn(<span class="string">&lsquo;sigma&rsquo;</span>,[1 0.5; 0.5 3;]),2,1);
gaussianSet2(1).mu = [2 -2];
gaussianSet2(2).mu = [-2 2];</p>

<p>mixture2 = prtRvMixture(<span class="string">&lsquo;components&rsquo;</span>,gaussianSet2,<span class="string">&lsquo;mixingProportions&rsquo;</span>,[0.5 0.5]);</p>

<p>ds = prtDataSetClass( cat(1,mixture1.draw(500),mixture2.draw(500)), prtUtilY(500,500)); <span class="comment">% Draw 500 samples from each mixture</span>
plot(ds)
</pre><img vspace="5" hspace="5" src="/images/morton_blog_20130227_02.png" alt=""> <h2>Using prtRvMixtures for Classification<a name="6"></a></h2><p>Like we showed in part 1 of this series we can set the &ldquo;rvs&rdquo; property of prtClassMap to any prtRv object and use that rv for classification. Let&rsquo;s for prtClassMap to use a mixture of prtRvMvn objects.</p><pre class="codeinput">emptyMixture = prtRvMixture(<span class="string">&lsquo;components&rsquo;</span>,repmat(prtRvMvn,2,1)); <span class="comment">% 2 component mixture</span></p>

<p>classifier = prtClassMap(<span class="string">&lsquo;rvs&rsquo;</span>,emptyMixture);</p>

<p>trainedClassifier = train(classifier, ds);</p>

<p>plot(trainedClassifier);
</pre><img vspace="5" hspace="5" src="/images/morton_blog_20130227_03.png" alt=""> <p>As you can see it looks like this classifier would perform quite well. We can see that the learned means of the class 0 data (blue) closely match the means that we specified above for guassianSet1. So things appear to be working well.</p><pre class="codeinput">cat(1,trainedClassifier.rvs(1).components.mu)
</pre><pre class="codeoutput">ans =
   -1.9712   -2.0488</p>

<pre><code>2.0139    1.9548
</code></pre>

<p></pre><h2>prtRvGmm<a name="8"></a></h2><p>Since Guassian mixture models are the most common type of mixture a number of techniques have been established that help them perform better when working with limited and/or high dimensional data. To help facilitate some of those tweak there is prtRvGmm. It works much the same way as prtRvMixture only the components must be prtRvMvns.</p><pre class="codeinput">mixture1Gmm = prtRvGmm(<span class="string">&lsquo;components&rsquo;</span>,gaussianSet1,<span class="string">&lsquo;mixingProportions&rsquo;</span>,[0.5 0.5]);</p>

<p>plotPdf(mixture1Gmm);
</pre><img vspace="5" hspace="5" src="/images/morton_blog_20130227_04.png" alt=""> <p>One of the available tweaks is that the covarianceStructure of all components is controled by a single parameter, &ldquo;covarianceStructure&#8217;. See the documentation prtRvMvn to know how this works. Let&rsquo;s see how changing the covarianceStructure of all of our components changes the appears of our density.</p><pre class="codeinput">mixture1GmmMod = mixture1Gmm;
mixture1GmmMod.covarianceStructure = <span class="string">&lsquo;spherical&rsquo;</span>; <span class="comment">% Force independence with a shared variance.</span></p>

<p>plotPdf(mixture1GmmMod);
</pre><img vspace="5" hspace="5" src="/images/morton_blog_20130227_05.png" alt=""> <h2>Using prtRvGmm for classification<a name="10"></a></h2><p>Using prtRvGmm for classification is a little easier than prtRvMixture because we only need to specify the number of components. We don&rsquo;t have to built the array of components ourselves.</p><p>Let&rsquo;s redo the same problem as before.</p><pre class="codeinput">classifier = prtClassMap(<span class="string">&lsquo;rvs&rsquo;</span>,prtRvGmm(<span class="string">&lsquo;nComponents&rsquo;</span>,2));
trainedClassifier = train(classifier,ds);
plot(trainedClassifier);
</pre><img vspace="5" hspace="5" src="/images/morton_blog_20130227_06.png" alt=""> <p>As you can see, things look nearly identical (as they should). Now, let&rsquo;s make use of a few of the extra tweak offered by prtRvGmm and see how they change our decision contours.</p><pre class="codeinput">classifier = prtClassMap(<span class="string">&lsquo;rvs&rsquo;</span>,prtRvGmm(<span class="string">&lsquo;nComponents&rsquo;</span>,2,<span class="string">&lsquo;covarianceStructure&rsquo;</span>,<span class="string">&lsquo;spherical&rsquo;</span>,<span class="string">&lsquo;covariancePool&rsquo;</span>,true));
trainedClassifier = train(classifier,ds);
plot(trainedClassifier);
</pre><img vspace="5" hspace="5" src="/images/morton_blog_20130227_07.png" alt=""> <p>You can see that the decision contours are more regular now. This may help classificaiton performance in the precense of limited and/or high dimensional data.</p><h2>Conclusions<a name="13"></a></h2><p>We hope this post showed how you can use mixture models just like any other prtRv object when doing classificaiton using prtClassMap.</p><p>Chances are that you want to use prtRvGmm for your mixture modeling needs but you might be able to guess that prtRvMixture is much more general allowing you to make mixture models out of general prtRvs. However, at this time the only prtRv that is able to be used is prtRvMvn. We are interested in making more prtRvs compatible but we want to know what people want to use. Let us know if you need something specific.</p><p>In the next part of this series we will look at prtRvHmm and how it can be used for time-series classification.</p></p>
</div>


<br>
<hr>
<br>
    <footer>
      <p class="meta">
        
  

<span class="byline author vcard">Posted by <span class="fn">Kenny</span></span>

        








  


<time datetime="2013-03-24T11:03:00-04:00" pubdate data-updated="true">Mar 24<span>th</span>, 2013</time>
        


      </p>
      
        <div class="sharing">
  <br/>
  
  
  
</div>

      
      <p class="meta">
        
          <a class="basic-alignment pull-left" href="/blog/2013/03/19/feature-selection/" title="Previous Post: Feature Selection - prtFeatSelSfs">&laquo; Feature Selection - prtFeatSelSfs</a>
        
        
          <a class="basic-alignment pull-right" href="/blog/2013/04/02/determining-gender-from-handwriting/" title="Next Post: Determining Gender from Handwriting - A Kaggle Competition!">Determining Gender from Handwriting - A Kaggle Competition! &raquo;</a>
        
      </p>
    </footer>
    
    
      <section>
        <h1>Comments</h1>
        <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
      </section>
    
  </div>

  
    
  <div class="span3 sidebar">
    <div class="well">
      
        <section>
  <h2>Recent Posts</h2>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2013/07/24/using-svms/">Using SVMs</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/07/15/observation-info/">Observation Info</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/07/08/twoclassparadigm/">twoClassParadigm</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/06/24/spectral-clustering/">Spectral Clustering</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/06/13/prtclustermeanshift/">prtClusterMeanShift</a>
      </li>
    
  </ul>
</section>


      
    </div>
  </div>


  
</div>


      </div>
    </div>
    <footer class="footer"><p>
  Copyright &copy; 2013 - Kenneth Morton and Peter Torrione -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span> -
  
    <span class="credit">Theme by <a href="http://brianarmstrong.org">Brian Armstrong</a></span>
  
</p>
</footer>
    

<script type="text/javascript">
      var disqus_shortname = 'newfolderconsulting';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://newfolder.github.io/blog/2013/03/24/rvs-part-2/';
        var disqus_url = 'http://newfolder.github.io/blog/2013/03/24/rvs-part-2/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>







<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
<script src="/assets/bootstrap/js/bootstrap.min.js"></script>


  </div>
</body>
</html>
